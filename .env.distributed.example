# Configuration pour le mode distribué ebook2audiobook
# Copier ce fichier vers .env.distributed et ajuster les valeurs

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_PASSWORD=
# Laisser vide pour pas de password (dev/test)
# En production, utiliser un mot de passe fort : openssl rand -base64 32

# ============================================================================
# DISTRIBUTED MODE SETTINGS
# ============================================================================
DISTRIBUTED_MODE=true
NUM_WORKERS=2
# Nombre de workers attendus (pour coordination)

# ============================================================================
# STORAGE CONFIGURATION
# ============================================================================
SHARED_STORAGE_TYPE=nfs
# Options: nfs, s3, local
# - nfs: Montage NFS partagé (recommandé pour cluster local)
# - s3: Amazon S3 ou compatible (MinIO)
# - local: Docker volume local (dev/test seulement)

SHARED_STORAGE_PATH=/mnt/shared
# Chemin du stockage partagé dans les containers

# Configuration S3 (si SHARED_STORAGE_TYPE=s3)
S3_ENDPOINT_URL=
# Ex: https://s3.amazonaws.com ou http://minio:9000
S3_BUCKET_NAME=ebook2audiobook
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# ============================================================================
# WORKER GPU CONFIGURATION
# ============================================================================
WORKER_GPU_ID=
# ID du GPU à utiliser (0, 1, 2, etc.)
# Laisser vide pour auto-detection
# Pour multi-GPU, utiliser docker-compose scale avec différents IDs

# ============================================================================
# FLOWER MONITORING
# ============================================================================
FLOWER_USER=admin
FLOWER_PASSWORD=admin
# Changer en production !

# ============================================================================
# CELERY TUNING
# ============================================================================
CELERY_WORKER_CONCURRENCY=1
# Nombre de tâches simultanées par worker
# Recommandé: 1 pour isolation GPU

CELERY_TASK_TIME_LIMIT=3600
# Timeout max par tâche (secondes)
# 3600 = 1 heure

CELERY_WORKER_MAX_TASKS_PER_CHILD=50
# Redémarre worker après N tâches (libère mémoire GPU)

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=INFO
# Options: DEBUG, INFO, WARNING, ERROR

# ============================================================================
# NETWORK (optionnel)
# ============================================================================
# REDIS_HOST=redis
# REDIS_PORT=6379
# Si Redis sur serveur distant, ajuster ici

# ============================================================================
# NFS MOUNT (si SHARED_STORAGE_TYPE=nfs)
# ============================================================================
# NFS_SERVER=192.168.1.100
# NFS_PATH=/exports/ebook2audio
# Ajuster dans docker-compose.distributed.yml volumes section

# ============================================================================
# DEVELOPMENT / DEBUGGING
# ============================================================================
# SKIP_MODEL_LOAD=false
# Set to true pour skip chargement TTS (tests rapides)

# CELERY_TASK_ALWAYS_EAGER=false
# Set to true pour exécuter tâches synchroniquement (debug)
